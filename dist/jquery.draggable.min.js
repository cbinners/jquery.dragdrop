/*! jQuery DragDrop Draggable - v0.1.0-dev - 2015-03-17
* https://github.com/steveluscher/jquery.dragdrop
* Copyright (c) 2015 Steven Luscher, Ruboss Technology Corporation; Licensed MIT */
(function(){var a=[].slice;null==jQuery.dragdrop&&(jQuery.dragdrop=function(){function b(){}var c;return c=function(a,b,c){return parseFloat(c.css(a))||(parseFloat(c.css(b))?c.position()[a]:0)},b.prototype.getCSSLeft=function(a){return c("left","right",a)},b.prototype.getCSSTop=function(a){return c("top","bottom",a)},b.prototype.getConfig=function(){return this.config||(this.config=this.applyDefaults(this.options,this.defaults))},b.prototype.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},b.prototype.isNumber=function(a){return a===+a||"[object Number]"===toString.call(a)},b.prototype.isNaN=function(a){return this.isNumber(a)&&window.isNaN(a)},b.prototype.applyDefaults=function(){var b,c,d,e,f,g;for(b=arguments[0],e=2<=arguments.length?a.call(arguments,1):[],f=0,g=e.length;g>f;f++)if(d=e[f])for(c in d)void 0===b[c]&&(b[c]=d[c]);return b},b.prototype.synthesizeEvent=function(a,b){var c,d,e;c=jQuery.Event(b),c.type=a,c.target=this.$element.get(0);for(d in b)e=b[d],d in c||(c[d]=e);return c},b.prototype.getEventMetadata=function(a,b){var c;return c={position:a||{top:this.getCSSTop(this.$helper),left:this.getCSSLeft(this.$helper)},offset:b||this.$helper.offset()},(null!=this.helperStartPosition||null!=this.draggable)&&(c.originalPosition={top:(this.helperStartPosition||this.draggable.helperStartPosition).y,left:(this.helperStartPosition||this.draggable.helperStartPosition).x}),null!=this.$helper&&(c.helper=this.$helper),null!=this.draggable&&(c.draggable=this.draggable.$element),c},b}())}).call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};jQuery(function(){return jQuery.draggable=function(b){function d(b,c){this.options=null!=c?c:{},this.handleElementClick=a(this.handleElementClick,this),this.handleDocumentMouseUp=a(this.handleDocumentMouseUp,this),this.handleDocumentMouseMove=a(this.handleDocumentMouseMove,this),this.handleElementMouseDown=a(this.handleElementMouseDown,this),d.__super__.constructor.apply(this,arguments),h(),this.$element=$(b),this.$element.on({mousedown:this.handleElementMouseDown,click:this.handleElementClick}).addClass(this.getConfig().draggableClass)}var e,f,g,h,i;return c(d,b),i=["ms","moz","webkit","o"],e=function(a){return"webkit"===a?"WebKit":a.charAt(0).toUpperCase()+a.slice(1)},h=function(){var a,b,c,d;for(a=0,c=0,d=i.length;d>c&&(b=i[c],window.requestAnimationFrame||(window.requestAnimationFrame=window[b+"RequestAnimationFrame"]),window.cancelAnimationFrame||(window.cancelAnimationFrame=window[b+"CancelAnimationFrame"]||window[b+"CancelRequestAnimationFrame"]),!window.requestAnimationFrame||!window.cancelAnimationFrame);c++);return window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c,d,e;return c=(new Date).getTime(),e=Math.max(0,16-(c-a)),d=window.setTimeout(function(){return b(c+e)},e),a=c+e,d}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){return clearTimeout(a)}),h=function(){}},g=function(){var a,b,c,d;for(a=function(a){var b,c;for(b=a.offsetLeft-a.scrollLeft,c=a.offsetTop-a.scrollTop;a=a.offsetParent;)b+=(a.offsetLeft||0)-a.scrollLeft,c+=(a.offsetTop||0)-a.scrollTop;return{left:Math.round(b),top:Math.round(c)}},c=0,d=i.length;d>c&&(b=i[c],window.convertPointFromPageToNode||(window.convertPointFromPageToNode=window[b+"ConvertPointFromPageToNode"]),window.convertPointFromNodeToPage||(window.convertPointFromNodeToPage=window[b+"ConvertPointFromNodeToPage"]),window.Point||(window.Point=window[e(b)+"Point"]),!(window.convertPointFromPageToNode&&window.convertPointFromNodeToPage&&window.Point));c++);return window.Point||(window.Point=function(){function a(a,b,c){this.x=null!=a?a:0,this.y=null!=b?b:0,this.z=null!=c?c:0}return a}()),window.convertPointFromPageToNode||(window.convertPointFromPageToNode=function(b,c){var d;return d=a(b),new Point(c.x-d.left,c.y-d.top)}),window.convertPointFromNodeToPage||(window.convertPointFromNodeToPage=function(b,c){var d;return d=a(b),new Point(d.left+c.x,d.top+c.y)}),g=function(){}},d.prototype.defaults={draggableClass:"ui-draggable",draggingClass:"ui-draggable-dragging",helper:"original",stack:!1,containment:!1,cursorAt:!1,distance:!1},d.prototype.setupElement=function(){var a,b,c,d,e;for(b=this.getConfig(),"original"===b.helper&&"static"===this.$element.css("position")&&this.$element.css({position:"relative"}),e=["start","drag","stop"],c=0,d=e.length;d>c;c++)a=e[c],"function"==typeof b[a]&&(b[a]=b[a].bind(this));return this.setupPerformed=!0},d.prototype.handleElementMouseDown=function(a){var b;if(a.originalEvent.jQueryDragdropAlreadyHandled!==!0&&(b=1===a.which,b&&(this.cancelAnyScheduledDrag(),this.shouldCancelClick=!1,!this.isCancelingAgent(a.target)&&this.isValidHandle(a.target))))return g(),a.originalEvent.jQueryDragdropAlreadyHandled=!0,$(document.body).one("mousedown",function(a){var b;return a.preventDefault(),b=$(document.activeElement),b.is(this)?void 0:b.blur()}),this.mousedownEvent=a,$(document).on({mousemove:this.handleDocumentMouseMove,mouseup:this.handleDocumentMouseUp})},d.prototype.handleDocumentMouseMove=function(a){var b,c,d,e;return this.dragStarted?this.handleDrag(a):(e=this.getConfig().distance,null!=e&&(b=a.clientX-this.mousedownEvent.clientX,c=a.clientY-this.mousedownEvent.clientY,d=Math.sqrt(Math.pow(b,2)+Math.pow(c,2)),e>d)?!0:(this.handleDragStart(a),this.dragStarted?(this.handleDrag(a,!0),this.broadcast("start",a)):void 0))},d.prototype.handleDocumentMouseUp=function(a){var b;return(b=1===a.which)?this.handleDragStop(a):void 0},d.prototype.handleElementClick=function(a){return this.shouldCancelClick?(a.stopImmediatePropagation(),!1):void 0},d.prototype.handleDragStart=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return this.setupPerformed||this.setupElement(),i=this.getConfig().helper,j="original"!==i,k=j?$('<div style="height: 0; width: 0; visibility: none">').appendTo("body"):this.$element,this.parent=this.getOffsetParentOrTransformedParent(j?k:this.$element),j&&k.remove(),r=j||this.isAbsoluteish(this.$element)&&this.isPositionedImplicitly(this.$element),this.elementStartPageOffset=convertPointFromNodeToPage(this.$element.get(0),new Point(0,0)),this.helperStartPosition=r?(g=!j&&this.isTransformed(this.$element.get(0))?(q=this.$element.css("transform"),this.$element.css("transform","none"),o=convertPointFromNodeToPage(this.$element.get(0),new Point(0,0)),this.$element.css("transform",q),o):this.elementStartPageOffset,u=convertPointFromPageToNode(this.parent,g),this.isTransformed(this.parent)?(u.x+=this.parent.scrollLeft,u.y+=this.parent.scrollTop):void 0,u):new Point(this.getCSSLeft(this.$element),this.getCSSTop(this.$element)),(c=this.getConfig().cursorAt)&&(d=convertPointFromPageToNode(this.$element.get(0),new Point(this.mousedownEvent.clientX,this.mousedownEvent.clientY)),m=c.left,null!=c.right&&(p=this.$element.width()-c.right),v=c.top,null!=c.bottom&&(b=this.$element.height()-c.bottom),l=null!=m&&null!=p?Math.abs(d.x-m)<Math.abs(d.x-p)?m:p:m||p||d.x,w=null!=v&&null!=b?Math.abs(d.y-v)<Math.abs(d.y-b)?v:b:v||b||d.y,n=convertPointFromNodeToPage(this.$element.get(0),new Point(l,w)),e={left:this.mousedownEvent.clientX-n.x,top:this.mousedownEvent.clientY-n.y},this.helperStartPosition.x+=e.left,this.helperStartPosition.y+=e.top,this.elementStartPageOffset.x+=e.left,this.elementStartPageOffset.y+=e.top),u=this.pointToPosition(this.helperStartPosition),t=this.pointToPosition(this.elementStartPageOffset),h=this.getEventMetadata(u,t),f=this.synthesizeEvent("dragstart",a),("function"==typeof(x=this.getConfig()).start?x.start(f,h):void 0)===!1?void this.handleDragStop(a):(this.cancelAnyScheduledDrag(),this.originalPointerEventsPropertyValue=this.$element.css("pointerEvents"),this.$helper="clone"===i?this.synthesizeHelperByCloning(this.$element):"function"==typeof i?this.synthesizeHelperUsingFactory(i,a):this.$element,this.$helper.addClass(this.getConfig().draggingClass).css({pointerEvents:"none"}),j&&this.$helper.appendTo("body"),!j&&(s=this.getConfig().stack)&&this.moveHelperToTopOfStack(s,a),this.getConfig().containment!==!1&&(this.bounds=this.calculateContainmentBounds()),y=convertPointFromPageToNode(this.parent,new Point(this.mousedownEvent.pageX,this.mousedownEvent.pageY)),this.mousedownEvent.LocalX=y.x,this.mousedownEvent.LocalY=y.y,this.dragStarted=!0,jQuery.draggable.draggableAloft=this,this.$element.trigger(f,h))},d.prototype.handleDrag=function(a,b){var c,d=this;return null==b&&(b=!1),c=function(){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return i=convertPointFromPageToNode(d.parent,new Point(a.pageX,a.pageY)),c={x:i.x-d.mousedownEvent.LocalX,y:i.y-d.mousedownEvent.LocalY},s={left:d.helperStartPosition.x+c.x,top:d.helperStartPosition.y+c.y},q={left:d.elementStartPageOffset.x+(a.pageX-d.mousedownEvent.pageX),top:d.elementStartPageOffset.y+(a.pageY-d.mousedownEvent.pageY)},d.bounds&&(g={top:d.$helper.css("top"),left:d.$helper.css("left")},d.$helper.css(s),n=d.getPageRelativeBoundingBox(d.$helper,[0,d.helperSize.width,d.helperSize.height,0]),m=d.bounds[0]-n[0],l=n[1]-d.bounds[1],j=n[2]-d.bounds[2],k=d.bounds[3]-n[3],(k>0||l>0)&&(r=Math.max(0,(k+l)/2),o=k>l?k-r:r-l),(m>0||j>0)&&(r=Math.max(0,(m+j)/2),p=m>j?m-r:r-j),o||p?(o&&(q.left+=o),p&&(q.top+=p),b=convertPointFromPageToNode(d.parent,new Point(a.pageX+(o||0),a.pageY+(p||0))),s.left+=b.x-i.x,s.top+=b.y-i.y):h=!0),f=d.getEventMetadata(s,q),e=d.synthesizeEvent("drag",a),("function"==typeof(t=d.getConfig()).drag?t.drag(e,f):void 0)===!1?(g&&d.$helper.css(g),void d.handleDragStop(a)):(h||d.$helper.css(f.position),d.$element.trigger(e,f))},b?c():this.scheduleDrag(c)},d.prototype.handleDragStop=function(a){var b,c,d;return this.cancelAnyScheduledDrag(),$(document).off({mousemove:this.handleMouseMove,mouseup:this.handleMouseUp}),this.dragStarted&&(delete jQuery.draggable.draggableAloft,delete jQuery.draggable.latestEvent,this.shouldCancelClick=!!this.dragStarted,b=this.synthesizeEvent("dragstop",a),c=this.getEventMetadata(),"function"==typeof(d=this.getConfig()).stop&&d.stop(b,c),this.$element.trigger(b,c),this.broadcast("stop",a),"original"===this.getConfig().helper?this.$helper.removeClass(this.getConfig().draggingClass):(this.$helper.remove(),this.$element.trigger("click",a)),this.$element.css({pointerEvents:this.originalPointerEventsPropertyValue})),this.cleanUp()},d.prototype.isAbsoluteish=function(a){return/fixed|absolute/.test($(a).css("position"))},d.prototype.isPositionedImplicitly=function(a){var b;return b=$(a),"auto"===b.css("top")&&"auto"===b.css("bottom")?!0:"auto"===b.css("left")&&"auto"===b.css("right")?!0:void 0},d.prototype.isCancelingAgent=function(a){return this.getConfig().cancel?!!$(a).closest(this.getConfig().cancel).length:!1},d.prototype.isValidHandle=function(a){return this.getConfig().handle?!!$(a).closest(this.getConfig().handle).length:!0},d.prototype.isTransformed=function(a){return"none"!==f(a)},d.prototype.broadcast=function(a,b){var c;return c=this.synthesizeEvent(a,b),jQuery.draggable.latestEvent=c,$(jQuery.draggable.prototype).trigger(c,this)},d.prototype.getPageRelativeBoundingBox=function(a,b){var c,d,e,f,g,h,i;for(f=[],g=[],d=[[b[3],b[0]],[b[1],b[0]],[b[1],b[2]],[b[3],b[2]]],h=0,i=d.length;i>h;h++)c=d[h],e=convertPointFromNodeToPage(a.get(0),new Point(c[0],c[1])),f.push(e.x),g.push(e.y);return[Math.min.apply(this,g),Math.max.apply(this,f),Math.max.apply(this,g),Math.min.apply(this,f)]},d.prototype.calculateContainmentBounds=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return i=this.getConfig().containment,(k=this.isArray(i)?i.slice(0):(b=function(){switch(i){case"parent":return this.$element.parent();case"window":return $(window);case"document":return $(document.documentElement);default:return $(i)}}.call(this),b.length?$(window).is(b)?(p=b.scrollLeft(),q=b.scrollTop(),[p,p+b.width(),q+b.height(),p]):(h=b.width(),c=b.height(),g=parseFloat(b.css("paddingTop"))||0,e=parseFloat(b.css("paddingLeft"))||0,f=parseFloat(b.css("borderTopWidth"))||0,d=parseFloat(b.css("borderLeftWidth"))||0,o=g+f,a=o+c,j=e+d,n=j+h,this.getPageRelativeBoundingBox(b,[o,n,a,j])):void 0))?(this.helperMargins={top:parseFloat(this.$helper.css("marginTop"))||0,right:parseFloat(this.$helper.css("marginRight"))||0,bottom:parseFloat(this.$helper.css("marginBottom"))||0,left:parseFloat(this.$helper.css("marginLeft"))||0},this.helperSize={height:this.$helper.outerHeight(),width:this.$helper.outerWidth()},(this.helperMargins.top||this.helperMargins.right||this.helperMargins.bottom||this.helperMargins.left)&&(l=this.getPageRelativeBoundingBox(this.$helper,[0,this.helperSize.width,this.helperSize.height,0]),m=this.getPageRelativeBoundingBox(this.$helper,[-this.helperMargins.top,this.helperSize.width+this.helperMargins.right,this.helperSize.height+this.helperMargins.bottom,-this.helperMargins.left]),k[0]-=m[0]-l[0],k[1]-=m[1]-l[1],k[2]-=m[2]-l[2],k[3]-=m[3]-l[3],k[0]>k[2]&&(k[0]=k[2]=k[2]+(k[0]-k[2])/2),k[1]<k[3]&&(k[1]=k[3]=k[1]+(k[3]-k[1])/2)),k):void 0},d.prototype.cancelAnyScheduledDrag=function(){return this.scheduledDragId?(cancelAnimationFrame(this.scheduledDragId),this.scheduledDragId=null):void 0},f=function(a){var b;return(b=getComputedStyle(a))?b.WebkitTransform||b.msTransform||b.MozTransform||b.OTransform||"none":"none"},d.prototype.getOffsetParentOrTransformedParent=function(a){var b,c,d,e,f,g;for(b=$(a),d=document.documentElement,g=b.parents().get(),e=0,f=g.length;f>e;e++)if(c=g[e],"static"!==$(c).css("position")||this.isTransformed(c)){d=c;break}return d},d.prototype.scheduleDrag=function(a){var b=this;return this.cancelAnyScheduledDrag(),this.scheduledDragId=requestAnimationFrame(function(){return a(),b.scheduledDragId=null})},d.prototype.synthesizeHelperByCloning=function(a){var b;return b=a.clone(),b.removeAttr("id"),this.prepareHelper(b)},d.prototype.synthesizeHelperUsingFactory=function(a,b){var c,d;if(d=a(this.$element,b),c=$(d).first(),!c.length)throw new Error("[jQuery DragDrop – Draggable] Helper factory methods must produce a jQuery object, a DOM Element, or a string of HTML");return this.prepareHelper(c.first())},d.prototype.moveHelperToTopOfStack=function(a,b){var c,d,e,f;return c=$(("function"==typeof a?a(this.$helper,b):void 0)||a),c.length&&(d=c.get().sort(function(a,b){return(parseInt($(b).css("zIndex"),10)||0)-(parseInt($(a).css("zIndex"),10)||0)}),!this.$helper.is(f=d[0]))?(e=$(f).css("zIndex"),this.$helper.css("zIndex",parseInt(e,10)+1)):void 0},d.prototype.positionToPoint=function(a){return new Point(a.left,a.top)},d.prototype.pointToPosition=function(a){return{left:a.x,top:a.y}},d.prototype.prepareHelper=function(a){var b;return b={},"absolute"!==a.css("position")&&(b.position="absolute"),b.left=this.elementStartPageOffset.x,b.top=this.elementStartPageOffset.y,a.css(b)},d.prototype.cleanUp=function(){return this.dragStarted=!1,delete this.$helper,delete this.bounds,delete this.elementStartPageOffset,delete this.helperMargins,delete this.helperSize,delete this.helperStartPosition,delete this.mousedownEvent,delete this.originalPointerEventsPropertyValue,delete this.parent},d}(jQuery.dragdrop),$.fn.draggable=function(a){return this.each(function(){var b;return null==$(this).data("draggable")?(b=new $.draggable(this,a),$(this).data("draggable",b)):void 0})}})}.call(this);